(this["webpackJsonptool-catalogue"]=this["webpackJsonptool-catalogue"]||[]).push([[0],{123:function(e,t,n){e.exports=n(191)},128:function(e,t,n){},130:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},163:function(e,t){},164:function(e,t){},170:function(e,t){},172:function(e,t){},188:function(e,t,n){"use strict";(function(e){var t=n(68),r=n(14),a=n(4),o=n(6),i=n(37),c=n(26),l=n(38),s=n(0),u=n.n(s),p=n(18),f=n.n(p),d=n(51);n(189);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=Object(d.WidthProvider)(d.Responsive),y=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"toolbox__items__item",onClick:this.props.onTakeItem.bind(void 0,this.props.item)},this.props.item.i)}}]),t}(u.a.Component);u.a.Component;function g(){return f.a.map(f.a.range(0,25),(function(e,t){var n=Math.ceil(4*Math.random())+1;return{x:2*f.a.random(0,5)%12,y:Math.floor(t/6)*n,w:2,h:n,i:t.toString(),static:Math.random()<.05}}))}(function(n){function s(n){var o;return Object(a.a)(this,s),(o=Object(i.a)(this,Object(c.a)(s).call(this,n))).onBreakpointChange=function(e){o.setState((function(t){return{currentBreakpoint:e,toolbox:h({},t.toolbox,Object(r.a)({},e,t.toolbox[e]||t.toolbox[t.currentBreakpoint]||[]))}}))},o.onCompactTypeChange=function(){var e=o.state.compactType,t="horizontal"===e?"vertical":"vertical"===e?null:"horizontal";o.setState({compactType:t})},o.onTakeItem=function(e){o.setState((function(n){return{toolbox:h({},n.toolbox,Object(r.a)({},n.currentBreakpoint,n.toolbox[n.currentBreakpoint].filter((function(t){return t.i!==e.i})))),layouts:h({},n.layouts,Object(r.a)({},n.currentBreakpoint,[].concat(Object(t.a)(n.layouts[n.currentBreakpoint]),[e])))}}))},o.onPutItem=function(e){o.setState((function(n){return{toolbox:h({},n.toolbox,Object(r.a)({},n.currentBreakpoint,[].concat(Object(t.a)(n.toolbox[n.currentBreakpoint]||[]),[e]))),layouts:h({},n.layouts,Object(r.a)({},n.currentBreakpoint,n.layouts[n.currentBreakpoint].filter((function(t){return t.i!==e.i}))))}}))},o.onLayoutChange=function(t,n){var a,i;a="layouts",i=n,e.localStorage&&e.localStorage.setItem("rgl-8",JSON.stringify(Object(r.a)({},a,i))),o.props.persist&&o.props.persist(n),o.setState({layouts:n})},o.onNewLayout=function(){o.setState({layouts:{lg:g()}})},o.state={currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:n.layouts?n.layouts:{lg:n.tools?n.tools.map((function(e,t){return{x:0,y:t,w:3,h:3,i:t.toString(),static:0}})):n.initialLayout},toolbox:{lg:[]}},o}return Object(l.a)(s,n),Object(o.a)(s,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"generateDOM",value:function(){var e=this,t=this;return f.a.map(this.state.layouts[this.state.currentBreakpoint],(function(n){var r=t.props.tools&&t.props.tools[n.i]&&t.props.tools[n.i].tile?t.props.tools[n.i].tile:{title:n.i};return u.a.createElement("div",{style:{backgroundColor:r.color,color:r.textcolor,cursor:e.props.editingLayout?"default":"pointer"},onClick:function(){e.props.onTileClick&&!e.props.editingLayout&&e.props.onTileClick(r)},key:n.i,className:n.static?"static":""},u.a.createElement("img",{src:r.icon,style:{height:"100%",maxHeight:"128px",width:"auto",padding:"8px"}}),u.a.createElement("span",{className:"text"},r.title," "))}))}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(b,Object.assign({},this.props,{isDraggable:this.editingLayout,layouts:this.state.layouts,onBreakpointChange:this.onBreakpointChange,onLayoutChange:this.onLayoutChange,measureBeforeMount:!1,useCSSTransforms:this.state.mounted,compactType:this.state.compactType,preventCollision:!this.state.compactType}),this.generateDOM()))}}]),s}(u.a.Component)).defaultProps={className:"layout",rowHeight:30,onLayoutChange:function(){},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},initialLayout:g()}}).call(this,n(19))},189:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(24),i=n.n(o),c=(n(128),n(14)),l=n(2),s=n.n(l),u=n(11),p=n(7);n(130),n(131),n(132),n(133);var f=n(30),d=n.n(f),m=n(18),h=n.n(m),b=function(e){return e&&e.references?a.a.createElement("div",{className:"tags",style:{display:"flex",flexWrap:"wrap"}},e.references.map((function(e,t){return a.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px",backgroundColor:e.color,color:e.textColor}},e.title)}))):null},y=function(e){if(!e.text)return null;if(!e.filter)return e.text;var t=e.text.toLowerCase().indexOf(e.filter.toLowerCase());if(-1===t)return e.text;var n=e.text.substr(0,t),r=e.text.substr(t,e.filter.length),o=e.text.substr(t+e.filter.length);return a.a.createElement(a.a.Fragment,null,a.a.createElement("span",null,n),a.a.createElement("span",{style:e.style},r),a.a.createElement("span",null,o))},g=function(e){var t=e.tile?e.tile:{},n=Object(r.useState)(""),o=Object(p.a)(n,2);o[0],o[1];return a.a.createElement(a.a.Fragment,null,1===e.tileSize&&a.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},a.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:70,maxHeight:70,overflow:"hide"}},a.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{margin:8,marginTop:8,height:40}},a.a.createElement("img",{style:{height:"auto",width:40},src:t.icon})),a.a.createElement("div",{style:{flexGrow:1,lineHeight:"40px",marginTop:"6px",marginLeft:"4px",fontSize:"24px"}},a.a.createElement(y,{text:t.title,filter:e.filter,style:e.highlightStyle})),a.a.createElement("div",{style:{alignItems:"flex-end"}},a.a.createElement("i",{style:{cursor:"pointer",display:"none"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))," ")))),0===e.tileSize&&a.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},a.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:300,maxHeight:300,overflow:"auto"}},a.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{flexGrow:1}},a.a.createElement(y,{text:t.title,filter:e.filter,style:e.highlightStyle})," "),a.a.createElement("div",{style:{alignItems:"flex-end"}},a.a.createElement("i",{style:{cursor:"pointer",display:"none"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))),a.a.createElement("div",{style:{textAlign:"center",margin:20,marginTop:40,height:120}},a.a.createElement("img",{style:{height:"auto",width:112},src:t.icon})),a.a.createElement("div",{style:{maxHeight:60,height:60,overflow:"auto"}},t.inShort),a.a.createElement(b,{references:t.references}))),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,rel:"noopener noreferrer",target:"_blank"},"More info"))))},v=n(99),x=function(e){var t=e.tile?e.tile:{},n=Object(r.useState)(""),o=Object(p.a)(n,2),i=o[0],c=o[1],l=Object(r.useState)(null),s=Object(p.a)(l,2),u=s[0],f=s[1];return Object(r.useEffect)((function(){t.contentRef&&d.a.get(t.contentRef).then((function(e){var t=new v.QuillDeltaToHtmlConverter(e.data.ops);c(t.convert())})).catch((function(e){404!==e.response.status&&f(e.message)}))})),a.a.createElement(a.a.Fragment,null,u&&a.a.createElement("div",null,u),a.a.createElement("div",{onClick:e.onClose,style:{backgroundColor:t.color,color:t.textcolor,width:"100vw",height:"100vh",overflow:"auto"}},a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{minWidth:"10vw"}}," ",a.a.createElement("img",{style:{margin:"1vh",height:"auto",width:"10vw"},src:t.icon})),a.a.createElement("div",{style:{height:"10vh",width:"auto"}},a.a.createElement("div",{className:"fullSizeHeading",style:{padding:"3vh",fontSize:"5vh",textOverflow:"nowrap",whiteSpace:"no-wrap"}},t.title),a.a.createElement("div",{className:"fullSizeDescription",style:{paddingLeft:"3vh",fontSize:"3vh"}},t.inShort))),a.a.createElement("div",{style:{height:"80vh",overflow:"auto",backgroundColor:"#ffffff",color:"#000000",padding:"20px"}},a.a.createElement(b,{references:t.references}),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:i}})),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")))))},w=n(218),k=n(110),O=n(32),j=n(109),E=n(101),S=n(4),C=n(6);function T(){try{return window.self!==window.top}catch(e){return!0}}var P=function(){function e(t,n){Object(S.a)(this,e),this.options=n,this.msalApplication=t}return Object(C.a)(e,[{key:"getAccessToken",value:function(e){var t=this,n=this;return new Promise(function(){var r=Object(u.a)(s.a.mark((function r(a,o){var i,c,l,u,p,f,d,m;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("undefined"!==typeof(i=e)&&(c=i.scopes),"undefined"!==typeof c&&0!==c.length||(c=t.options.scopes),0!==c.length){r.next=8;break}throw(l=new Error).name="EmptyScopes",l.message="Scopes cannot be empty, Please provide a scopes",l;case 8:if(n.msalApplication.handleRedirectCallback((function(e,t){if(e)return o(e)})),!t.msalApplication.getAccount()){r.next=42;break}return u={scopes:c},r.prev=11,r.next=14,t.msalApplication.acquireTokenSilent(u);case 14:p=r.sent,a(p.accessToken),r.next=40;break;case 18:if(r.prev=18,r.t0=r.catch(11),!(r.t0 instanceof O.a)){r.next=38;break}if(r.prev=21,!T()){r.next=29;break}return r.next=25,t.msalApplication.acquireTokenPopup(u);case 25:f=r.sent,a(f.accessToken),r.next=30;break;case 29:case 30:r.next=36;break;case 32:r.prev=32,r.t1=r.catch(21),o(r.t1);case 36:r.next=40;break;case 38:o(r.t0);case 40:r.next=60;break;case 42:if(r.prev=42,d={scopes:c},!T()){r.next=53;break}return r.next=47,t.msalApplication.loginPopup(d);case 47:return r.next=49,t.msalApplication.acquireTokenSilent(d);case 49:m=r.sent,a(m.accessToken),r.next=55;break;case 53:return n.msalApplication.loginRedirect(d),r.abrupt("return");case 55:r.next=60;break;case 57:r.prev=57,r.t2=r.catch(42),o(r.t2);case 60:case"end":return r.stop()}}),r,null,[[11,18],[21,32],[42,57]])})));return function(e,t){return r.apply(this,arguments)}}())}}]),e}(),L=n(161),I=(n(165),["User.Read.All","User.ReadWrite.All","mail.send","Files.ReadWrite.All"]),A={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,authority:"https://login.microsoftonline.com/common"}};new O.b(A).handleRedirectCallback((function(e,t){}));var B={authProvider:new P(new O.b(A),new E.MSALAuthenticationProviderOptions(I))},R={layouts:{pending:!1}};function N(){return j.a.initWithMiddleware(B)}function D(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var a,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=N(),t.prev=1,t.next=4,a.api(e).get();case 4:return o=t.sent,t.abrupt("return",n(o));case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",r(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}())}function _(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var a,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=N(),t.next=4,a.api("/me/drive/items/".concat(e.id,":/tile.xlsx:")).get();case 4:o=t.sent,d()({url:o["@microsoft.graph.downloadUrl"],method:"GET",responseType:"arraybuffer"}).then((function(e){var t=L.read(e.data,{type:"buffer"});if(!t.Sheets.ZTICKYBAR)return n(null);var r=L.utils.sheet_to_json(t.Sheets.ZTICKYBAR,{header:1,raw:!1}),a={};r.forEach((function(e){a[e[0]]=e[1]})),n(a)})),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),n(null);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}())}function W(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,a){var o,i;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=N(),n.next=4,o.api("/me/drive/items/".concat(e.id,":/").concat(t,":")).get();case 4:i=n.sent,d.a.get(i["@microsoft.graph.downloadUrl"]).then((function(e){r(e.data)})),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),r(null);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t){return n.apply(this,arguments)}}())}function F(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_(e);case 3:if(!(a=t.sent)){t.next=6;break}return t.abrupt("return",n(a));case 6:n({}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),r(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())}function G(e){return new Promise((function(t,n){try{var r=URL.createObjectURL(e),a=new XMLHttpRequest;a.responseType="blob",a.onload=function(){var e=a.response,n=new FileReader;n.onload=function(){var e=n.result;t(e)},n.readAsDataURL(e)},a.open("GET",r),a.send()}catch(o){t(null)}}))}function z(){setTimeout((function(){if(console.log("delaywriteLayouts"),R.layouts.pending)return R.layouts.writing?z():void H(R.layouts.folder,R.layouts.data)}),500)}var M="layouts.json";function H(e,t,n,r){var a={version:1,layouts:t,properties:n};return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,o){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("writeLayouts"),!(R&&R.layouts&&R.layouts.writing)){t.next=10;break}if(!h.a.isEqual(R.layouts.data,a)){t.next=5;break}return console.log("writeLayouts no changes"),t.abrupt("return",n());case 5:return R.layouts.pending=!0,R.layouts.data=a,R.layouts.folder=e,z(),t.abrupt("return",n());case 10:if(t.prev=10,!r){t.next=14;break}return localStorage.setItem(M,JSON.stringify(a)),t.abrupt("return",n());case 14:return R.layouts.writing=!0,R.layouts.current=a,i=N(),console.log("writeLayouts > got Client"),t.next=20,i.api("/me/drive/items/".concat(e.id,":/layouts.json:/content")).put(a);case 20:console.log("writeLayouts > wrote"),n(),t.next=28;break;case 24:return t.prev=24,t.t0=t.catch(10),console.log("writeLayouts > error",t.t0),t.abrupt("return",o(t.t0));case 28:return t.prev=28,R.layouts.writing=!1,t.finish(28);case 31:case"end":return t.stop()}}),t,null,[[10,24,28,31]])})));return function(e,n){return t.apply(this,arguments)}}())}var K={me:function(){return D("/me")},rootSite:function(){return D("/sites/root")},initStorage:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=N(),e.prev=1,e.next=4,r.api("/me/drive/root:/ZTICKYBAR").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,o={name:"ZTICKYBAR",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,r.api("/me/drive/root/children").post(o);case 15:return i=e.sent,e.abrupt("return",t(i));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",n(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",n(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,n){return e.apply(this,arguments)}}())},initTileStorage:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=N(),e.prev=1,e.next=4,r.api("/me/drive/root:/ZTICKYBAR/tiles").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,o={name:"tiles",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,r.api("/me/drive/root:/ZTICKYBAR:/children").post(o);case 15:return i=e.sent,e.abrupt("return",t(i));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",n(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",n(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,n){return e.apply(this,arguments)}}())},addTile:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,a){var o,i,c,l,u,p,f,d,m,b;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=N(),n.prev=1,i=t.tableId?t.title+" ("+t.tableId.replace("/","-")+")":t.title,c={name:i,folder:{},"@microsoft.graph.conflictBehavior":"replace"},n.next=6,o.api("/me/drive/items/".concat(e.id,"/children")).post(c);case 6:return l=n.sent,u=h.a.keys(t),p=[],u.forEach((function(e){"references"!==e&&p.push([e,t[e]])})),f=L.utils.book_new(),d=L.utils.aoa_to_sheet(p),L.utils.book_append_sheet(f,d,"ZTICKYBAR"),m={bookType:"xlsx",bookSST:!1,type:"array"},b=L.write(f,m),n.next=17,o.api("/me/drive/items/".concat(l.id,":/tile.xlsx:/content")).put(b);case 17:return n.sent,l.tile=t,n.abrupt("return",r(l));case 22:return n.prev=22,n.t0=n.catch(1),n.abrupt("return",a(n.t0));case 26:case"end":return n.stop()}}),n,null,[[1,22]])})));return function(e,t){return n.apply(this,arguments)}}())},getMyTools:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,a){var o,i,c,l;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t){n.next=5;break}if(!(o=localStorage.getItem("mytools"))){n.next=5;break}return n.abrupt("return",r(JSON.parse(o)));case 5:return i=N(),n.next=8,i.api("/me/drive/items/".concat(e.id,"/children")).get();case 8:if(c=n.sent,l=0,0!==c.value.length){n.next=12;break}return n.abrupt("return",r(c.value));case 12:c.value.forEach(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l++,e.next=3,F(t);case 3:if(t.tile=e.sent,0!==--l){e.next=8;break}return localStorage.setItem("mytools",JSON.stringify(c.value)),e.abrupt("return",r(c.value));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),a(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e,t){return n.apply(this,arguments)}}())},teamMemberships:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],e.prev=1,(a=N()).api("/me/joinedTeams").get(function(){var e=Object(u.a)(s.a.mark((function e(o,i){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",n(o));case 2:c=0,i.value.map(function(){var e=Object(u.a)(s.a.mark((function e(n){var o,i,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c++,e.prev=1,e.next=4,a.api("/groups/".concat(n.id,"/photo/$value")).get();case 4:return o=e.sent,e.next=7,G(o);case 7:i=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:return e.next=14,a.api("/teams/".concat(n.id)).get();case 14:return l=e.sent,e.next=17,a.api("/teams/".concat(n.id,"/channels")).version("beta").get();case 17:if(u=e.sent,r.push({key:n.id,text:n.displayName,title:n.description,data:{details:l,photo:i,channels:u.value}}),0!==--c){e.next=22;break}return e.abrupt("return",t(r.sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))));case 22:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",n(e.t0));case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}())},writeLayouts:H,readLayouts:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,a){var o,i;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=13;break}if(o=localStorage.getItem(M)){n.next=4;break}return n.abrupt("return",r(null));case 4:return n.prev=4,i=JSON.parse(o),n.abrupt("return",r([i.layouts,i.properties,i.version]));case 9:return n.prev=9,n.t0=n.catch(4),console.log("error parsing local storagee layouts",n.t0),n.abrupt("return",r(null));case 13:return n.next=15,W(e,"layouts.json");case 15:i=n.sent,r(i?[i.layouts,i.properties,i.version]:[{lg:[]},{},-1]);case 18:case"end":return n.stop()}}),n,null,[[4,9]])})));return function(e,t){return n.apply(this,arguments)}}())}},U=n(217),J=n(221),q=n(222),Y=(n(177),n(178),n(179),n(51),n(188),n(190),n(66)),Z=n.n(Y),$=n(210),Q="jumpto365.com/APAC%20DIGITAL%20WORKPLACE",V="https://pro.jumpto365.com/@/"+Q,X="https://api.jumpto365.com/table/"+Q,ee={clientId:"",scopes:["user.read"],title:"Tools",logo:Z.a,defaultTable:V,defaultTableAPI:X,defaultTableKey:Q,options:[{key:"fruitsHeader",text:"NTTDATA",itemType:$.a.Header},{key:{id:"nets.eu/2019-q4",api:"https://api.jumpto365.com/table/nets.eu/2019-q4",web:"https://pro.jumpto365.com/@/nets.eu/2019-q4"},text:"One Tenant - Wave 1"},{key:{id:"nets.eu/digital-workplace",api:"https://api.jumpto365.com/table/nets.eu/digital-workplace",web:"https://pro.jumpto365.com/@/nets.eu/digital-workplace"},text:"Digital Workplace"},{key:{id:"nets.eu/group-tech-highlevel",api:"https://api.jumpto365.com/table/nets.eu/group-tech-highlevel",web:"https://pro.jumpto365.com/@/nets.eu/group-tech-highlevel"},text:"Group Tech Playbook"},{key:"divider_1",text:"-",itemType:$.a.Divider},{key:"jumpto365",text:"Generic Periodic Tables",itemType:$.a.Header},{key:{id:Q,api:X,web:V},text:"Office 365"},{key:{id:"jumpto365.com/ems5",api:"https://api.jumpto365.com/table/jumpto365.com/ems5",web:"https://pro.jumpto365.com/@/jumpto365.com/ems5"},text:"EMS"}],components:{header:a.a.createElement("div",{style:{borderBottom:"1px solid #cccccc",paddingTop:"8px"}},a.a.createElement("div",{style:{display:"flex",margin:"20px"}},a.a.createElement("div",null,a.a.createElement("img",{style:{height:"40px",padding:"4px"},src:Z.a})),a.a.createElement("div",{style:{marginLeft:"16px",fontSize:"20px",lineHeight:"20px",padding:"4px"}},"APAC Digital Workplace")))}};function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object(k.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement((function(){var e=Object(r.useState)(""),t=Object(p.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(""),c=Object(p.a)(i,2),l=c[0],f=c[1],m=Object(r.useState)([]),b=Object(p.a)(m,2),y=b[0],v=b[1],k=Object(r.useState)(!1),O=Object(p.a)(k,2),j=O[0],E=(O[1],Object(r.useState)(!1)),S=Object(p.a)(E,2),C=(S[0],S[1],Object(r.useState)(!1)),T=Object(p.a)(C,2),P=T[0],L=T[1],I=Object(r.useState)(null),A=Object(p.a)(I,2),B=A[0],R=A[1],N=Object(r.useState)({}),D=Object(p.a)(N,2),_=(D[0],D[1]),W=Object(r.useState)({}),F=Object(p.a)(W,2),G=F[0],z=F[1],M=Object(r.useState)([]),H=Object(p.a)(M,2),Y=H[0],Z=H[1],$=Object(r.useState)(""),Q=Object(p.a)($,2),V=Q[0],X=Q[1],te=Object(r.useState)(1),re=Object(p.a)(te,2),ae=re[0],oe=re[1],ie=Object(r.useState)([]),ce=Object(p.a)(ie,2),le=ce[0],se=ce[1],ue=Object(r.useState)([]),pe=Object(p.a)(ue,2),fe=pe[0],de=(pe[1],Object(r.useState)("")),me=Object(p.a)(de,2),he=(me[0],me[1],Object(r.useState)("")),be=Object(p.a)(he,2),ye=(be[0],be[1],Object(r.useState)(!1)),ge=Object(p.a)(ye,2),ve=ge[0],xe=ge[1],we=Object(r.useState)(""),ke=Object(p.a)(we,2),Oe=ke[0],je=ke[1],Ee=Object(r.useState)(!1),Se=Object(p.a)(Ee,2),Ce=Se[0],Te=Se[1],Pe=Object(r.useState)(!0),Le=Object(p.a)(Pe,2),Ie=(Le[0],Le[1],Object(r.useState)(!1)),Ae=Object(p.a)(Ie,2),Be=Ae[0],Re=(Ae[1],Object(r.useState)("")),Ne=Object(p.a)(Re,2),De=Ne[0],_e=Ne[1],We=Object(r.useState)({}),Fe=Object(p.a)(We,2),Ge=Fe[0],ze=Fe[1],Me=Object(r.useState)("pinned"),He=Object(p.a)(Me,2),Ke=(He[0],He[1],Object(r.useState)("https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE")),Ue=Object(p.a)(Ke,2),Je=Ue[0],qe=Ue[1],Ye=Object(r.useState)(""),Ze=Object(p.a)(Ye,2),$e=Ze[0],Qe=Ze[1],Ve=Object(r.useState)([]),Xe=Object(p.a)(Ve,2),et=Xe[0],tt=Xe[1],nt=function(){try{return window.self!==window.top}catch(e){return!0}}();function rt(e,t){d.a.get(e).then((function(n){var r=n.data;o(r.titlegraphics);var a=[];if(r.grid){var i={},c={};r.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(i[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var n=c[t]?c[t]:[];n.push(e.groupSetting),c[t]=n})))}))}));var l=h.a.keys(i).map((function(e){return ne({title:e},i[e])}));tt(h.a.sortBy(l,["title"])),r.grid.forEach((function(n){return n.forEach((function(n){if(n.tile&&n.tile.title){var r=ne({},n.tile);r.tableId=t,r.correlation=e+"#"+(r.key?r.key:r.title?r.title.toLowerCase():r.id);var o=c[n.id];r.references=o,a.push(r)}}))}))}v(h.a.sortBy(a,["title","href"]))}))}function at(e){return ot.apply(this,arguments)}function ot(){return(ot=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t&&(localStorage.removeItem("memberships"),localStorage.removeItem("mytools")),n=0,xe(!0),e.next=6,K.initStorage();case 6:K.initTileStorage().then(function(){var e=Object(u.a)(s.a.mark((function e(r){var a,o,i,c,l,u,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(r),n++,e.next=4,K.readLayouts(r);case 4:if(a=e.sent,o=Object(p.a)(a,3),i=o[0],c=o[1],l=o[2],u=[],!(l<0)){e.next=17;break}return e.next=13,K.getMyTools(r,t);case 13:f=e.sent,u=f.map((function(e){return{title:e.tile?e.tile.title:e.name,tile:e.tile}})),e.next=18;break;case 17:u=c.tiles.map((function(e){return e?{title:e.title,tile:e}:null}));case 18:0===--n&&xe(!1),Z(u),ze(i);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){--n<=0&&xe(!1),le.push({context:"OfficeGraph.initStorage()",error:e}),se(le)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),le.push({context:"initGraph",error:e.t0}),se(le);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function it(e){var t=e&&e.title&&-1!==e.title.toLowerCase().indexOf(l.toLowerCase());return t||(t=e&&e.inShort&&-1!==e.inShort.toLowerCase().indexOf(l.toLowerCase())),t||(t=e&&e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(l.toLowerCase())),t}Object(r.useEffect)((function(){j&&(at(),K.me().then((function(e){_(e),window.document.title=e.displayName+" Tools"})).catch((function(e){le.push({context:"OfficeGraph.me()",error:e}),se(le)})));var e=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var r=n[1].split("&"),a=0;a<r.length;a++){var o=r[a].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}(window.location.href);e.ztickyref&&X(e.ztickyref);var t=e.src?e.src:ee.defaultTableAPI;_e(ee.defaultTableAPI),rt(t,ee.defaultTableKey)}),[]);var ct=l?[]:y,lt=l?[]:Y,st=l?[]:fe;V&&new URL(V),l&&(y.forEach((function(e){it(e)&&ct.push(e)})),Y.forEach((function(e){it(e.tile)&&lt.push(e)})),fe.forEach((function(e){(function(e){var t=e.data&&e.data.details?e.data.details:{},n=e.data&&e.data.channels?e.data.channels:[],r=t.displayName&&-1!==t.displayName.toLowerCase().indexOf(l.toLowerCase());return r||(r=t.description&&-1!==t.description.toLowerCase().indexOf(l.toLowerCase())),n.forEach((function(e){r||(r=e.displayName&&-1!==e.displayName.toLowerCase().indexOf(l.toLowerCase())),r||(r=e.description&&-1!==e.description.toLowerCase().indexOf(l.toLowerCase()))})),r})(e)&&st.push(e)})));var ut={dropdown:{width:300}};return a.a.createElement("div",null,!nt&&ee.components.header,a.a.createElement("div",{style:{paddingRight:"20px",paddingLeft:"20px"}}," ",Oe&&a.a.createElement("div",{style:{backgroundColor:"white",width:"100vw",position:"fixed",top:"0px"}},a.a.createElement(J.a,{xlabel:"Example title",description:Oe})),a.a.createElement("img",{style:{display:"none",height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:n}),P&&a.a.createElement("div",null,a.a.createElement(x,{tile:B||(y?y[0]:null),onClose:function(){L(!1)}})),!P&&a.a.createElement("div",{style:{display:"flex"}}," ",a.a.createElement("div",{style:{display:"none",paddingRight:"8px",position:"fixed",bottom:"0px",backgroundColor:"white"}},a.a.createElement("a",{href:G.webUrl,target:"_blank"},a.a.createElement("i",{style:{cursor:"pointer",padding:"4px",color:"black"},class:"ms-Icon ms-Icon--OpenFolderHorizontal","aria-hidden":"true"})," "),a.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--Refresh",onClick:function(){at(!0)},"aria-hidden":"true"})," ",ve&&a.a.createElement(a.a.Fragment,null,"Loading")),a.a.createElement("div",{style:{position:"fixed",right:0,top:0,zIndex:32,marginRight:"16px"}},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{padding:"8px",marginTop:"0px"}},"Table view"),a.a.createElement("div",{style:{marginTop:"8px"}},a.a.createElement(q.a,{xlabel:"Show Table",checked:Ce,xonText:"Table view On",xoffText:"Table view Off",onChange:function(e,t){Te(t)}})))),a.a.createElement("div",{style:{flexGrow:"1"}},lt.length>0&&a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},lt.map((function(e,t){var n=e.tile?e.tile:{title:e.name,color:"#dddddd"};return a.a.createElement(g,{tileSize:ae,isPinned:!0,key:t,tile:n,filter:l,highlightStyle:{backgroundColor:"yellow",color:"#333"},onClick:function(e){if(e.jumpto)return window.open(e.jumpto,"_blank");R(e),L(!0)}})})))),a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"8px"}},a.a.createElement("div",{style:{marginLeft:"16px",flexGrow:0}},a.a.createElement(U.a,{placeholder:"Select an area",label:"Area",onChanged:function(e,t){rt(e.key.api,e.key.id),_e(e.key.web),qe(e.key.api),Qe("")},xxselectedKey:Je,options:ee.options,styles:ut})),a.a.createElement("div",{style:{marginLeft:"16px",flexGrow:0}},a.a.createElement(U.a,{placeholder:"Select a group",label:"Group",onChanged:function(e,t){Qe(e.key)},selectedKey:$e,options:et?et.map((function(e){return{key:e.groupSetting.title,text:e.groupSetting.title}})):[],styles:ut})),a.a.createElement("div",{style:{padding:"0px",marginLeft:"8px",flexGrow:1}},a.a.createElement(w.a,{disabled:Ce,style:{maxWidth:"300px"},label:"Filter",value:l,onChange:function(e,t){f(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}}))," ",a.a.createElement("div",{style:{marginLeft:"16px",flexGrow:0}},a.a.createElement(U.a,{disabled:Ce,placeholder:"Select tile size",selectedKey:ae,label:"View as",onChanged:function(e,t){oe(e.key)},options:[{key:0,text:"Tile"},{key:1,text:"Small"}],styles:ut}))),Ce&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--OpenInNewWindow",onClick:function(){window.open(De,"_blank")},"aria-hidden":"true"})),a.a.createElement("iframe",{style:{border:"0",height:"calc(100vh - 150px",width:"95vw"},src:De})),!Ce&&a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},ct.map((function(e,t){if($e){var n=!1;if(!e.references)return a.a.createElement(a.a.Fragment,null);if(e.references.forEach((function(e){e.title===$e&&(n=!0)})),!n)return a.a.createElement(a.a.Fragment,null)}return a.a.createElement(g,{tileSize:ae,key:t,filter:l,highlightStyle:{backgroundColor:"yellow",color:"#333"},tile:e,onPinnedClicked:function(e){e.tile&&function(e){je("Adding pin"),K.addTile(G,e).then(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{Y.push(t),h.a.keys(Ge).forEach((function(e){Ge[e].push({x:0,y:1/0,w:3,h:3,i:Ge[e].length.toString(),static:0})})),ze(Ge),Z(Y)}catch(n){le.push({context:"AddTile > myTools.push() ",error:n}),se(le)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){le.push({context:"OfficeGraph.addTile()",error:e}),se(le)})).finally((function(){je("")}))}(e.tile)},onClick:function(e){if(e.jumpto)return window.open(e.jumpto,"_blank");R(e),L(!0)}})})))),Be&&a.a.createElement("div",{style:{borderLeft:"1px solid #dddddd",borderTop:"1px solid #dddddd",padding:"8px",float:"right",minWidth:"300px"}},a.a.createElement("div",{style:{padding:"0px"}},a.a.createElement(w.a,{label:"Filter",value:l,onChange:function(e,t){f(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}}))))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},66:function(e,t,n){e.exports=n.p+"static/media/logo.68a43b0c.svg"},85:function(e,t){}},[[123,1,2]]]);
//# sourceMappingURL=main.47dccf10.chunk.js.map